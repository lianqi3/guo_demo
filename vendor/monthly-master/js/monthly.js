(function(a){a.fn.extend({monthly:function(k){var i={weekStart:"Sun",mode:"",xmlUrl:"",target:"",eventList:true,maxWidth:false,setWidth:false,startHidden:false,showTrigger:"",stylePast:false,disablePast:false};var k=a.extend(i,k),m=this,n=a(this).attr("id"),f=new Date(),c=f.getMonth()+1,e=f.getFullYear(),b=f.getDate(),j=k.monthNames||["January","February","March","April","May","June","July","August","September","October","November","December"],g=k.dayNames||["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];if(k.maxWidth!=false){a("#"+n).css("maxWidth",k.maxWidth)}if(k.setWidth!=false){a("#"+n).css("width",k.setWidth)}if(k.startHidden==true){a("#"+n).addClass("monthly-pop").css({position:"absolute",display:"none"});a(document).on("focus",""+k.showTrigger+"",function(d){a("#"+n).show();d.preventDefault()});a(document).on("click",""+k.showTrigger+", .monthly-pop",function(d){d.stopPropagation();d.preventDefault()});a(document).on("click",function(d){a("#"+n).hide()})}if(k.weekStart=="Sun"){a("#"+n).append('<div class="monthly-day-title-wrap"><div>'+g[0]+"</div><div>"+g[1]+"</div><div>"+g[2]+"</div><div>"+g[3]+"</div><div>"+g[4]+"</div><div>"+g[5]+"</div><div>"+g[6]+'</div></div><div class="monthly-day-wrap"></div>')}else{if(k.weekStart=="Mon"){a("#"+n).append('<div class="monthly-day-title-wrap"><div>'+g[1]+"</div><div>"+g[2]+"</div><div>"+g[3]+"</div><div>"+g[4]+"</div><div>"+g[5]+"</div><div>"+g[6]+"</div><div>"+g[0]+'</div></div><div class="monthly-day-wrap"></div>')}else{console.error("Monthly.js has an incorrect entry for the weekStart variable")}}a("#"+n).prepend('<div class="monthly-header"><div class="monthly-header-title"></div><a href="#" class="monthly-prev"></a><a href="#" class="monthly-next"></a></div>').append('<div class="monthly-event-list"></div>');function h(d,p){return d===2?p&3||!(p%25)&&p&15?28:29:30+(d+(d>>3)&1)}function l(v,E){a("#"+n).data("setMonth",v).data("setYear",E);var q=h(v,E),w=v-1,t=new Date(E,w,1,0,0,0,0).getDay();a("#"+n+" .monthly-day, #"+n+" .monthly-day-blank").remove();a("#"+n+" .monthly-event-list").empty();a("#"+n+" .monthly-day-wrap").empty();if(k.mode=="event"){for(var u=0;u<q;u++){var d=u+1;var p=new Date(E,w,d,0,0,0,0).getDay();a("#"+n+" .monthly-day-wrap").append('<a href="#" class="m-d monthly-day monthly-day-event" data-number="'+d+'"><div class="monthly-day-number">'+d+'</div><div class="monthly-indicator-wrap"></div></a>');a("#"+n+" .monthly-event-list").append('<div class="monthly-list-item" id="'+n+"day"+d+'" data-number="'+d+'"><div class="monthly-event-list-date">'+g[p]+"<br>"+d+"</div></div>")}}else{for(var u=0;u<q;u++){var d=u+1;if(((d<b&&v===c)||E<e||(v<c&&E==e))&&k.stylePast==true){a("#"+n+" .monthly-day-wrap").append('<a href="#" data-toggle="modal" data-target="#schedule-box" class="m-d monthly-day monthly-day-pick monthly-past-day" data-number="'+d+'"><div class="monthly-day-number">'+d+'</div><div class="monthly-indicator-wrap"></div></a>')}else{a("#"+n+" .monthly-day-wrap").append('<a href="#" data-toggle="modal" data-target="#schedule-box" class="m-d monthly-day monthly-day-pick" data-number="'+d+'"><div class="monthly-day-number">'+d+'</div><div class="monthly-indicator-wrap"></div></a>')}}}var B=a("#"+n).data("setMonth"),C=a("#"+n).data("setYear");if(B==c&&C==e){a("#"+n+' *[data-number="'+b+'"]').addClass("monthly-today")}if(B==c&&C==e){a("#"+n+" .monthly-header-title").html(j[v-1]+" "+E)}else{a("#"+n+" .monthly-header-title").html(j[v-1]+" "+E+'<a href="#" class="monthly-reset" title="Back To This Month"></a> ')}if(k.weekStart=="Sun"&&t!=7){for(var u=0;u<t;u++){a("#"+n+" .monthly-day-wrap").prepend('<div class="m-d monthly-day-blank"><div class="monthly-day-number"></div></div>')}}else{if(k.weekStart=="Mon"&&t==0){for(var u=0;u<6;u++){a("#"+n+" .monthly-day-wrap").prepend('<div class="m-d monthly-day-blank" ><div class="monthly-day-number"></div></div>')}}else{if(k.weekStart=="Mon"&&t!=1){for(var u=0;u<(t-1);u++){a("#"+n+" .monthly-day-wrap").prepend('<div class="m-d monthly-day-blank" ><div class="monthly-day-number"></div></div>')}}}}var x=a("#"+n+" .monthly-day").length,z=a("#"+n+" .monthly-day-blank").length,D=x+z,A=Math.ceil(D/7)*7,r=A-D;if(D%7!=0){for(var u=0;u<r;u++){a("#"+n+" .monthly-day-wrap").append('<div class="m-d monthly-day-blank"><div class="monthly-day-number"></div></div>')}}if(k.mode=="event"){a.get(""+k.xmlUrl+"",function(y){a(y).find("event").each(function(){var S=a(this).find("startdate").text(),V=S.split("-"),ac=V[0],X=parseInt(V[1],10),W=parseInt(V[2],10),R=a(this).find("enddate").text(),F=R.split("-"),L=F[0],H=parseInt(F[1],10),G=parseInt(F[2],10),Q=a(this).find("url").text(),P=a(this).find("name").text(),M=a(this).find("color").text(),N=a(this).find("id").text(),aa=a(this).find("starttime").text(),Z=aa.split(":");J=a(this).find("endtime").text(),endSplit=J.split(":");O="",Y="AM",I="PM";if(parseInt(Z[0])>=12){var aa=(Z[0]-12)+":"+Z[1]+"";var Y="PM"}if(parseInt(aa)==0){var aa="12:"+Z[1]+""}if(parseInt(endSplit[0])>=12){var J=(endSplit[0]-12)+":"+endSplit[1]+"";var I="PM"}if(parseInt(J)==0){var J="12:"+endSplit[1]+""}if(Q){var O='href="'+Q+'"'}function U(){var ag="";if(aa){var af='<div><div class="monthly-list-time-start">'+aa+" "+Y+"</div>";var ae="";if(J){var ae='<div class="monthly-list-time-end">'+J+" "+I+"</div>"}var ag=af+ae+"</div>"}a("#"+n+' .monthly-list-item[data-number="'+T+'"]').addClass("item-has-event").append('<a href="'+Q+'" class="listed-event"  data-eventid="'+N+'" style="background:'+M+'" title="'+P+'">'+P+" "+ag+"</a>")}if(!R&&X==B&&ac==C){a("#"+n+' *[data-number="'+W+'"] .monthly-indicator-wrap').append('<div class="monthly-event-indicator"  data-eventid="'+N+'" style="background:'+M+'" title="'+P+'">'+P+"</div>");var ad="";if(aa){var ab='<div><div class="monthly-list-time-start">'+aa+" "+Y+"</div>";var K="";if(J){var K='<div class="monthly-list-time-end">'+J+" "+I+"</div>"}var ad=ab+K+"</div>"}a("#"+n+' .monthly-list-item[data-number="'+W+'"]').addClass("item-has-event").append('<a href="'+Q+'" class="listed-event"  data-eventid="'+N+'" style="background:'+M+'" title="'+P+'">'+P+" "+ad+"</a>")}else{if(X==B&&ac==C&&H==B&&L==C){for(var T=parseInt(W);T<=parseInt(G);T++){if(T==parseInt(W)){a("#"+n+' *[data-number="'+T+'"] .monthly-indicator-wrap').append('<div class="monthly-event-indicator" data-eventid="'+N+'" style="background:'+M+'" title="'+P+'">'+P+"</div>")}else{a("#"+n+' *[data-number="'+T+'"] .monthly-indicator-wrap').append('<div class="monthly-event-indicator" data-eventid="'+N+'" style="background:'+M+'" title="'+P+'"></div>')}U()}}else{if((H==B&&L==C)&&((X<B&&ac==C)||(ac<C))){for(var T=0;T<=parseInt(G);T++){if(T==1){a("#"+n+' *[data-number="'+T+'"] .monthly-indicator-wrap').append('<div class="monthly-event-indicator" data-eventid="'+N+'" style="background:'+M+'" title="'+P+'">'+P+"</div>")}else{a("#"+n+' *[data-number="'+T+'"] .monthly-indicator-wrap').append('<div class="monthly-event-indicator" data-eventid="'+N+'" style="background:'+M+'" title="'+P+'"></div>')}U()}}else{if((X==B&&ac==C)&&((H>B&&L==C)||(L>C))){for(var T=parseInt(W);T<=q;T++){if(T==parseInt(W)){a("#"+n+' *[data-number="'+T+'"] .monthly-indicator-wrap').append('<div class="monthly-event-indicator" data-eventid="'+N+'" style="background:'+M+'" title="'+P+'">'+P+"</div>")}else{a("#"+n+' *[data-number="'+T+'"] .monthly-indicator-wrap').append('<div class="monthly-event-indicator" data-eventid="'+N+'" style="background:'+M+'" title="'+P+'"></div>')}U()}}else{if(((X<B&&ac==C)||(ac<C))&&((H>B&&L==C)||(L>C))){for(var T=0;T<=q;T++){if(T==1){a("#"+n+' *[data-number="'+T+'"] .monthly-indicator-wrap').append('<div class="monthly-event-indicator" data-eventid="'+N+'" style="background:'+M+'" title="'+P+'">'+P+"</div>")}else{a("#"+n+' *[data-number="'+T+'"] .monthly-indicator-wrap').append('<div class="monthly-event-indicator" data-eventid="'+N+'" style="background:'+M+'" title="'+P+'"></div>')}U()}}}}}}})}).fail(function(){console.error("Monthly.js failed to import "+k.xmlUrl+". Please check for the correct path & XML syntax.")})}var s=a("#"+n+" .m-d");for(var u=0;u<s.length;u+=7){s.slice(u,u+7).wrapAll("<div class='monthly-week'></div>")}}l(c,e);function o(){if(a("#"+n+" .monthly-event-list").is(":visible")){a("#"+n+" .monthly-cal").remove();a("#"+n+" .monthly-header-title").prepend('<a href="#" class="monthly-cal" title="Back To Month View"><div></div></a>')}}a(document.body).on("click","#"+n+" .monthly-next",function(d){var r=a("#"+n).data("setMonth"),s=a("#"+n).data("setYear");if(r==12){var p=1,q=s+1;l(p,q)}else{var p=r+1,q=s;l(p,q)}o();d.preventDefault()});a(document.body).on("click","#"+n+" .monthly-prev",function(d){var r=a("#"+n).data("setMonth"),s=a("#"+n).data("setYear");if(r==1){var p=12,q=s-1;l(p,q)}else{var p=r-1,q=s;l(p,q)}o();d.preventDefault()});a(document.body).on("click","#"+n+" .monthly-reset",function(d){l(c,e);o();d.preventDefault();d.stopPropagation()});a(document.body).on("click","#"+n+" .monthly-cal",function(d){a(this).remove();a("#"+n+" .monthly-event-list").css("transform","scale(0)").delay("800").hide();d.preventDefault()});a(document.body).on("click","#"+n+" a.monthly-day",function(d){if(k.mode=="event"&&k.eventList==true){var t=a(this).data("number");a("#"+n+" .monthly-event-list").show();a("#"+n+" .monthly-event-list").css("transform");a("#"+n+" .monthly-event-list").css("transform","scale(1)");a("#"+n+' .monthly-list-item[data-number="'+t+'"]').show();var p=document.getElementById(n+"day"+t);var s=p.offsetTop;a("#"+n+" .monthly-event-list").scrollTop(s);o()}else{if(k.mode=="picker"){var t=a(this).data("number"),q=a("#"+n).data("setMonth"),r=a("#"+n).data("setYear");if(a(this).hasClass("monthly-past-day")&&k.disablePast==true){d.preventDefault()}else{a(""+k.target+"").val(q+"/"+t+"/"+r);if(k.startHidden==true){a("#"+n).hide()}}}}d.preventDefault()});a(document.body).on("click","#"+n+" .listed-event",function(d){var p=a(this).attr("href");if(!p){d.preventDefault()}})}})})(jQuery);